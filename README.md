# Asset Returns Calculator

A Python project for calculating asset returns with Jupyter notebook support, managed using Nix flakes and uv2nix for reproducible environments.

## Prerequisites

- Nix with flakes enabled ([installation guide](INSTALL-NIX.md))
- Git

## Quick Start

### Running Jupyter Notebook

```bash
# Launch Jupyter notebook
nix run

# Or explicitly
nix run .#notebook

# Launch Jupyter Lab instead
nix run .#lab
```

### Development Environment

```bash
# Enter development shell with all dependencies
nix develop

# Inside the shell, you have access to:
jupyter notebook  # Start Jupyter notebook
jupyter lab       # Start Jupyter Lab
python            # Python interpreter with all dependencies
uv                # UV package manager
```

## Project Management

### Adding Dependencies

1. Edit `pyproject.toml` to add new dependencies
2. Regenerate the lock file using the pinned UV version:
   ```bash
   nix develop .#bootstrap -c uv lock
   ```
3. Add the updated lock file to git:
   ```bash
   git add uv.lock
   ```

### Bootstrap Shell

The bootstrap shell is a minimal environment with just Python and UV, used for generating the `uv.lock` file before the full environment is built:

```bash
nix develop .#bootstrap
```

## Reproducibility

This project uses:
- **Nix flakes** for system-level reproducibility
- **uv2nix** to convert UV's lock file to Nix expressions
- **uv.lock** generated with a pinned UV version for Python dependency reproducibility

The Jupyter notebook version is specified in `pyproject.toml` and locked in `uv.lock`, ensuring the same version is used across Linux, macOS, and other systems (when using Nix).

## Limitations and Assumptions

This calculator is a simplified financial modeling tool with important limitations:

### Assumption-Based Forecasts

All projections rely on user-specified parameters such as:
- Interest rates
- Property growth rates
- Inflation rates
- Investment returns
- Other economic variables

These assumptions are essentially educated guesses about the future and may not reflect actual outcomes. Small changes in assumptions can lead to significantly different results.

### Expected Value Calculations

The calculator uses **expected values** (mean outcomes), which approximate the 50th percentile result in symmetric distributions. This means:
- Half of actual outcomes could be worse than projected
- Half could be better than projected
- Extreme outcomes (both positive and negative) are not explicitly modeled

### Ignored Risk Factors

The following important financial concepts are **not** accounted for:

1. **Volatility Drag**: When returns fluctuate, the compound growth rate is lower than the arithmetic average. For example, a +50% gain followed by a -50% loss results in a -25% total return, not 0%.

2. **Risk-Adjusted Returns**: The calculator treats all returns equally, ignoring that:
   - Higher volatility typically requires higher expected returns to be attractive
   - Correlation between assets affects portfolio risk
   - Sequence of returns matters (especially for withdrawal scenarios)

3. **Path Dependency**: The calculator doesn't model the many possible paths returns could take to reach an outcome. The journey matters, not just the destination.

4. **Behavioral Factors**: Real-world investment success depends on emotional discipline during market volatility, which mathematical models cannot capture.

### Disclaimer

**This tool is for educational and informational purposes only. It is NOT financial advice.**

The calculations and projections generated by this tool should not be the sole basis for financial decisions. Consider consulting with qualified financial professionals who can account for your specific circumstances, risk tolerance, and goals.

Past performance and mathematical models do not guarantee future results. All investments carry risk, including the potential loss of principal.

## Project Structure

- `pyproject.toml` - Python project configuration and dependencies
- `flake.nix` - Nix flake configuration with uv2nix integration
- `uv.lock` - UV lock file for Python dependencies
- `assetreturns.py` - Main Python module
- `test_assetreturns.py` - Tests
